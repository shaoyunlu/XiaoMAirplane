(function(i,e){typeof exports=="object"&&typeof module<"u"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):(i=typeof globalThis<"u"?globalThis:i||self,e(i.XMAirplane={}))})(this,function(i){"use strict";const e={MOUNTED:"mounted",BEFORE_BOOTSTRAP:"before_bootstrap",BOOTSTRAPPED:"bootstrapped",UNMOUNTED:"unmounted"},r=window.history.pushState,c=window.history.replaceState;function l(){window.history.pushState=(n,t,a)=>{const s=r.call(this,n,t,a);return p(),s},window.history.replaceState=(n,t,a)=>{const s=c.call(this,n,t,a);return p(),s},window.addEventListener("popstate",()=>{p()},!0),window.addEventListener("hashchange",()=>{p()},!0)}const o={};async function p(){const n=u(e.MOUNTED);await Promise.all(n.map(T));const t=u(e.BEFORE_BOOTSTRAP);await Promise.all(t.map(O));const a=[...u(e.BOOTSTRAPPED),...u(e.UNMOUNTED)];await Promise.all(a.map(h))}function d(n){o[n.name]={application:n,status:e.BEFORE_BOOTSTRAP}}function u(n){let t=[];return Object.keys(o).forEach(s=>{o[s].status==n&&t.push(o[s].application.loadApp())}),t}function f(){l(),p()}function O(n){n.then(t=>{t.bootstrap(),o[t.name].status=e.BOOTSTRAPPED})}function h(n){n.then(t=>{o[t.name].application.activeRule(window.location)&&(t.mount(),o[t.name].status=e.MOUNTED)})}function T(n){n.then(t=>{o[t.name].application.activeRule(window.location)||(t.unmount(),o[t.name].status=e.UNMOUNTED)})}i.registerApplication=d,i.start=f,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=xiaomairplane.umd.js.map
